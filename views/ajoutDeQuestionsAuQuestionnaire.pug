html
  include includes/head.pug
  body
    +navbar("SGA â€“ Ajouter des questions au questionnaire", user)

    .container.mt-5
      .text-center.mb-4
        h1.mb-2 Questions de la catÃ©gorie
        h4.text-muted Cours : #{group_id}
        h5.text-muted Questionnaire : #{nomQuestionnaire}
        h6.text-muted CatÃ©gorie : #{tag}

      if error
        .alert.alert-danger.text-center #{error}

      if lignes && lignes.length
        form(method="post" action=`/cours/${group_id}/questionnaires/${encodeURIComponent(nomQuestionnaire)}/categorie/${encodeURIComponent(tag)}/add`)
          .table-responsive
            table.table.table-hover
              thead
                tr
                  th(style="width:3rem")
                  th Titre
                  th CatÃ©gorie
                  th UtilisÃ©e
              tbody
                each l in lignes
                  tr
                    td
                      input.form-check-input(type="checkbox" name="questionsIds" value=l.titre)
                    td= l.titre
                    td= l.categorie || "(sans catÃ©gorie)"
                    td
                      span.badge.bg-secondary #{l.nbUtilisations} #{l.nbUtilisations > 1 ? 'fois' : 'fois'}

          .d-flex.justify-content-center.gap-3.mt-4
            button.btn.btn-primary(type="submit") ðŸ’¾ Sauvegarder le questionnaire
            a.btn.btn-secondary(href=`/cours/${group_id}/questionnaires/${encodeURIComponent(nomQuestionnaire)}/categories`) â¬…ï¸ Retour aux catÃ©gories
      else
        .alert.alert-info.text-center
          | Aucune question trouvÃ©e pour cette catÃ©gorie.
        .d-flex.justify-content-center.gap-3.mt-4
          a.btn.btn-secondary(href=`/cours/${group_id}/questionnaires/${encodeURIComponent(nomQuestionnaire)}/categories`) â¬…ï¸ Retour aux catÃ©gories
          a.btn.btn-outline-primary(href=`/cours/${group_id}/gestionQuestions`) âž• GÃ©rer les questions

  // --- Toast de confirmation / erreur ---
if message
  div#toast-message.alert.alert-success(style="position:fixed;bottom:1rem;right:1rem;z-index:1050;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.2);")
    strong âœ… #{message}
if error
  div#toast-message.alert.alert-danger(style="position:fixed;bottom:1rem;right:1rem;z-index:1050;padding:1rem 1.5rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.2);")
    strong âŒ #{error}

script.
  setTimeout(() => {
    const el = document.getElementById('toast-message');
    if (el) el.remove();
  }, 4000);
