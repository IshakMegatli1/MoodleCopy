doctype html
html(lang="fr")
  include includes/head.pug
  body
    +navbar("SGA â€“ Mes questionnaires", user)

    .container.mt-5
      h1.mb-4.text-center ğŸ“‹ Mes questionnaires

      if !groupQuestionnaires || Object.keys(groupQuestionnaires).length === 0
        .alert.alert-info.text-center
          strong â„¹ï¸ Aucun questionnaire disponible pour vos cours.
          p.mb-0.mt-2 VÃ©rifiez que vous Ãªtes bien inscrit Ã  des cours avec des questionnaires actifs.
      else
        //- Pour chaque groupe-cours de l'Ã©tudiant
        each gid in Object.keys(groupQuestionnaires).sort()
          - const info = groupInfos[gid] || { group_id: gid, titre: gid }
          - const qns = groupQuestionnaires[gid] || []
          
          .card.mb-4.shadow-sm
            .card-header.bg-primary.text-white
              .d-flex.justify-content-between.align-items-center
                div
                  h5.mb-0
                    | ğŸ“š #{info.titre}
                  small.text-white-50 #{info.group_id}
                div
                  if info.enseignant
                    small.badge.bg-light.text-dark ğŸ‘¨â€ğŸ« #{info.enseignant}
            
            .card-body
              if qns.length === 0
                p.text-muted.text-center.mb-0
                  em Aucun questionnaire disponible pour ce cours.
              else
                .table-responsive
                  table.table.table-hover.mb-0
                    thead
                      tr
                        th Questionnaire
                        th.text-center Questions
                        th.text-center Statut
                        th.text-end Action
                    tbody
                      each qn in qns
                        tr
                          td
                            strong= qn.nom
                            if qn.description
                              br
                              small.text-muted= qn.description
                          td.text-center
                            span.badge.bg-info.text-dark= qn.nombreQuestions || 0
                          td.text-center
                            if qn.actif
                              span.badge.bg-success âœ“ Actif
                            else
                              span.badge.bg-secondary âœ— Inactif
                          td.text-end
                            a.btn.btn-sm.btn-primary(href=qn.url) 
                              | ğŸ“ Ouvrir

      .mt-5.text-center
        a.btn.btn-secondary.btn-lg(href="javascript:history.back()") 
          | â¬…ï¸ Retour

    style.
      .card-header h5 { font-size: 1.1rem; }
      .table th { font-weight: 600; font-size: 0.9rem; }
      .table td { vertical-align: middle; }